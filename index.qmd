---
title: "扩散先验在类超声阴影缺失逆问题中的应用"
author: "马忠慧 (学号：25113060024)"
date: last-modified
format:
  html:
    number-sections: true
    toc: true
    code-tools: true
    theme: cosmo
---

::: {.callout-note appearance="simple"}
**课程作业信息**

- **学号**：25113060024
- **姓名**：马忠慧
:::

## 数学建模（从正问题到贝叶斯逆问题）

在生物医学图像处理与成像领域中，我们通常将“物理世界到信号的映射”称为正问题（forward problem），而将“由信号反推物理世界”的过程称为逆问题（inverse problem）。在数学建模中，物理世界中真实但不可直接观测的结构记为 $x$，通过成像系统获得的测量信号或图像记为 $y$。二者之间的关系可以用一个最直观的箭头示意来描述：从 $x$ 指向 $y$ 的过程对应正问题，而从 $y$ 指回 $x$ 的过程对应逆问题：

$$
x \xrightarrow{\text{正问题}} y,\qquad
y \xrightarrow{\text{逆问题}} x
$$ {#eq-forward-inverse}

需要强调的是，这两个方向在本质上并不对称。给定真实世界 $x$ 以及成像系统和物理规律，理论上可以确定性地计算出观测信号 $y$；而反过来，仅凭有限、退化且不可避免地受到噪声污染的观测 $y$，往往存在多个不同的 $x$ 都可以生成同一个 $y$。换言之，正问题通常是确定性的，而逆问题在本质上是不确定的。这种不对称性正是成像逆问题困难性的根源。基于这种不对称性，我们更倾向于用概率语言来表达逆问题中“相信程度”的更新（见公式 @eq-bayes）。

由于同一个观测 $y$ 可能对应多个可能的物理世界 $x$，逆问题的目标便不再适合被表述为“寻找唯一正确的解”。更合理的提法是：在当前可获得的信息条件下，我对不同候选 $x$ 的相信程度分别有多大？正是在这一点上，概率论成为刻画逆问题不可或缺的语言。这里需要特别指出的是，在逆问题中 $x$ 并不是物理意义上随机变化的随机变量，而是一个未知但固定的真实世界。概率并非用于描述世界本身的随机性，而是用于量化我们在信息不完备条件下对不同假设的认知不确定性。因此，先验分布 $p(x)$ 应被理解为：在尚未引入观测 $y$ 或仅基于已有知识时，对不同 $x$ 合理程度的主观相信。

在这一视角下，逆问题的核心对象自然转变为后验分布 $p(x\mid y)$，即在观测到信号 $y$ 之后，对真实世界 $x$ 的相信程度。贝叶斯公式为这一思想提供了严格而统一的数学表达：

$$
p(x\mid y) \propto p(y\mid x)\,p(x)
$$ {#eq-bayes}

其中，$p(x)$ 是先验分布，用以刻画“物理世界本来应当呈现的合理结构”；$p(y\mid x)$ 是似然函数，用以描述“若真实世界为 $x$，通过正问题生成当前观测 $y$ 的可能性”。后验分布 $p(x\mid y)$ 将这两方面信息整合在一起，既要求解在统计意义上符合对真实世界的先验认识，又要求其能够合理解释实际观测数据。从这一角度看，逆问题的解在最完整的意义上并不是单一的 $x$，而是关于 $x$ 的一个概率分布。

似然函数 $p(y\mid x)$ 的具体形式由正问题中的物理模型及噪声统计共同决定。在真实成像系统中，从 $x$ 到 $y$ 的映射几乎不可能被完全精确地描述，其中总会包含大量无法显式建模的因素，例如微观散射、系统建模误差、电子热散射以及数值离散与近似误差等。科学建模中通常将这些不可精确描述的影响统一归纳为噪声，并通过概率分布来刻画其统计特性。这并非简化问题的权宜之计，而是一种对模型不完备性的诚实表达。

在最基础、也最常见的建模假设下，我们采用加性噪声模型，将正问题写为：

$$
y = A(x) + n,
$$ {#eq-forward-noise}

其中 $A(\cdot)$ 表示正问题算子，例如模糊、遮挡、缺失或下采样等，$n$ 表示噪声项。若进一步假设噪声与信号无关，并服从独立同分布的高斯分布，则有：

$$
n \sim \mathcal{N}(0,\sigma^2 I),
$$ {#eq-gaussian-noise}

其中协方差矩阵 $\sigma^2 I$ 同时隐含了两个重要假设：其一，不同维度（如像素或采样点）之间的噪声相互独立；其二，噪声在所有方向上的强度相同，即各向同性。需要注意的是，独立性与各向同性是两个不同的概念：噪声可以在各维度之间相互独立但呈现各向异性（协方差矩阵为对角但对角元素不全相等），也可以表现出维度间的相关性（协方差矩阵具有非零的非对角元素）。这些假设将直接影响似然函数的几何结构。

一旦噪声模型被确定，似然函数的形式也随之明确。对于高斯噪声情形，似然可写为：

$$
p(y\mid x) = \mathcal{N}\big(A(x),\Sigma\big),
$$ {#eq-gaussian-likelihood}

其负对数形式（忽略常数项）等价于：

$$
(y-A(x))^\top \Sigma^{-1}(y-A(x)).
$$ {#eq-mahalanobis}

这表明，噪声协方差矩阵 $\Sigma$ 决定了误差在不同方向上的度量方式：当 $\Sigma=\sigma^2 I$ 时，该度量退化为熟悉的欧式距离；而当噪声存在相关性或各向异性时，误差的等高线从“圆形”变为“椭圆形”，从而改变后验分布的形状。由此可以看出，噪声模型并非建模中的次要细节，而是通过似然函数直接塑造了逆问题的后验结构。

---

### 交互演示：噪声协方差与几何形状

为了直观理解公式 @eq-mahalanobis 中协方差矩阵 $\Sigma$ 如何影响分布形状，你可以通过下方的滑块调整噪声在 $x, y$ 方向的标准差及相关性。请观察当相关性不为 0 时，分布如何从“正圆”变为倾斜的“椭圆”。

```{ojs}
import {Inputs} from "npm:@observablehq/inputs"
import * as Plot from "npm:@observablehq/plot"

viewof mu = Inputs.range([-5, 5], { value: 0, step: 0.01, label: "μ (mean)" })
viewof sigma = Inputs.range([0.1, 3], { value: 1, step: 0.01, label: "σ (std dev)" })

const variance = sigma * sigma
md`当前参数： μ=${mu.toFixed(2)}，σ=${sigma.toFixed(2)}，σ²=${variance.toFixed(2)}`

const xMin = -10
const xMax = 10

const data = Array.from({ length: 800 }, (_, i) => {
const x = xMin + (xMax - xMin) * (i / 799)
const z = (x - mu) / sigma
const y = Math.exp(-0.5 * z * z) / (sigma * Math.sqrt(2 * Math.PI))
return { x, y }
})

Plot.plot({
width: 720,
height: 360,
grid: true,
x: { label: "x", domain: [xMin, xMax] },
y: { label: "p(x)" },
marks: [Plot.line(data, { x: "x", y: "y" })]
})
```



