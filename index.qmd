---
title: ""
---

# 扩散先验在类超声阴影缺失逆问题中的应用 

- 学号：25113060024  
- 姓名：马忠慧

---




## 1. 问题
讲述声波传播奎律：声波在均匀介质中按照固定速度传播，当遇到阻抗不同的界面时，会发生变化；阻抗更大的界面会怎么样？阻抗更小的界面会怎么样？当声波从空气中传播遇到牙釉质，大量的能量会被反射，还有没有散射和折射？？？这种强散射会在成像的逆问题中产生很多伪影。- **骨后阴影**：强反射结构后面的信息缺失（像被黑块遮住）  
- **噪声/散斑**：让边界不清楚，影响三维表面提取与测量  
- **分辨率不均**：横向更糊、轴向相对更清
我做了一个可复现的 toy demo：把“类超声阴影缺失 + 噪声”的观测图像 **y**，用 **DDRM（扩散模型先验 + 数据一致性）** 重建回更接近真实结构的图像，并输出“不确定性图”。
---



---

# 第一节：DDRM 的问题建模与数学本质

> 本节目标：  
> - 明确 **DDRM 在解决什么问题**  
> - 搞清楚 **正问题 / 逆问题各自是什么**  
> - 看清 **数学在 DDRM 中具体干了哪些事**  
> - 为后续跑 demo、看代码、加物理约束打基础  

---

## 1. DDRM 是什么？

**DDRM = Denoising Diffusion Restoration Models**

它是一类 **用扩散模型（Diffusion Model）解决成像逆问题** 的方法。

一句话总结：

> **DDRM 用“学会的去噪能力”，来解物理成像中的逆问题。**

---

## 2. 先统一语言：什么是正问题？什么是逆问题？

### 2.1 正问题（Forward Problem）

**正问题：从真实物体 → 观测数据**

数学上通常写成：

\[
y = \mathcal{A}(x) + n
\]

- \(x\)：真实图像 / 真实物理场（ground truth）
- \(\mathcal{A}\)：物理成像算子  
  - 模糊（卷积）
  - 下采样
  - 投影
  - 欠采样傅里叶
- \(n\)：噪声（通常假设高斯噪声）

👉 **这是物理世界在干的事**，不是 AI 编的。

---

### 2.2 逆问题（Inverse Problem）

**逆问题：从观测数据 → 推断真实物体**

给定 \(y\)，求 \(x\)：

\[
\text{Given } y, \quad \text{find } x \text{ s.t. } y \approx \mathcal{A}(x)
\]

困难在于：

- \(\mathcal{A}\) **不可逆**
- 噪声存在
- 解 **不唯一 / 不稳定 / 病态**

👉 **逆问题本质上是一个“不适定问题”**

---

## 3. 一个关键澄清：正问题 ≠ 加噪，但加噪是正问题的一种

你刚才问的核心问题是对的：

> **正问题是加噪？逆问题是退噪？**

更精确的说法是：

- ✅ **加噪是一个“人为构造的正问题”**
- ❌ **真实物理正问题不一定只是加噪**

---

### 3.1 真实物理正问题

\[
y = \mathcal{A}(x) + n
\]

例如：

- 模糊 + 噪声
- 欠采样 + 噪声
- 投影 + 噪声

---

### 3.2 扩散模型里的“人工正问题”

在扩散模型中，**人为定义了一个正问题**：

\[
x_t = \sqrt{\alpha_t} x_0 + \sqrt{1-\alpha_t} \epsilon
\]

- \(x_0\)：干净图像
- \(x_t\)：加噪后的图像
- \(\epsilon \sim \mathcal{N}(0, I)\)

👉 这是 **为训练去噪模型而设计的正问题**  
👉 不是物理成像本身

---

## 4. 扩散模型在干什么？（数学角度）

### 4.1 训练阶段：学会“去噪”

目标是学一个网络：

\[
\epsilon_\theta(x_t, t) \approx \epsilon
\]

或者等价地：

\[
x_0 \approx \hat{x}_0(x_t)
\]

👉 本质：**学一个高维数据分布的 score / 梯度方向**

---

### 4.2 采样阶段：逐步反向去噪

从纯噪声开始：

\[
x_T \sim \mathcal{N}(0, I)
\]

一步步反向：

\[
x_{t-1} = f_\theta(x_t) + \text{noise}
\]

👉 **这是一个马尔可夫随机过程**

---

## 5. DDRM 的关键思想（真正重要）

> **DDRM = 扩散去噪 + 物理一致性约束**

### 5.1 核心问题

普通扩散模型：

- 只保证图像“看起来真实”
- ❌ 不保证符合观测数据 \(y\)

DDRM 要解决：

> **如何在去噪的同时，满足 \(y = \mathcal{A}(x)\)？**

---

### 5.2 DDRM 的数学操作（关键）

在每一步去噪中：

1. **扩散模型给出一个“自然图像方向”**
2. **用线性代数，把结果投影回物理可行空间**

形式上：

\[
x \leftarrow x + \mathcal{A}^\dagger (y - \mathcal{A}x)
\]

其中：

- \(\mathcal{A}^\dagger\)：伪逆 / 条件逆
- 本质是 **数据一致性（Data Consistency）**

👉 这一步是**纯数学 + 物理建模**  
👉 **不是神经网络学出来的**

---

## 6. DDRM 中数学到底在干什么？

不是“装饰”，而是**骨架**。

### 6.1 用到的数学工具

- 线性算子 \(\mathcal{A}\)
- SVD / 子空间分解
- 高斯分布
- 条件概率
- 伪逆 / 投影算子

---

### 6.2 数学分工总结

| 模块 | 数学角色 |
|---|---|
| 扩散正问题 | 构造噪声马尔可夫链 |
| 去噪网络 | 学 score / 条件期望 |
| 逆问题约束 | 解线性方程 / 投影 |
| 数据一致性 | 保证物理可行性 |

---

## 7. 一句话总结构图（强烈建议记住）

